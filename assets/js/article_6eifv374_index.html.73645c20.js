"use strict";(self.webpackChunkdesert_fisher=self.webpackChunkdesert_fisher||[]).push([[5350],{1953:(s,i,a)=>{a.r(i),a.d(i,{comp:()=>p,data:()=>e});var n=a(6254);const h=a.p+"assets/img/e8dd5433c357eda94f0db69d5fc0c9989444.d62e711d.webp",k=a.p+"assets/img/0db17e0b880167caae73ae1d053047827157.c10dec35.webp",l=a.p+"assets/img/8e23e0092e459ba360f377debbdc0fce4256.7918a884.webp",t={},p=(0,a(5459).A)(t,[["render",function(s,i){return(0,n.uX)(),(0,n.CE)("div",null,i[0]||(i[0]=[(0,n.Fv)('<p><img src="'+h+'" alt=""></p><h1 id="一、课程目标" tabindex="-1"><a class="header-anchor" href="#一、课程目标"><span>一、课程目标</span></a></h1><p>1.了解常见系统库的hook</p><p>2.了解frida_rpc</p><h1 id="二、工具" tabindex="-1"><a class="header-anchor" href="#二、工具"><span>二、工具</span></a></h1><p>1.教程Demo(更新)</p><p>2.jadx-gui</p><p>3.VS Code</p><p>4.jeb</p><p>5.IDLE</p><h1 id="三、课程内容" tabindex="-1"><a class="header-anchor" href="#三、课程内容"><span>三、课程内容</span></a></h1><h2 id="_1-hook-libart" tabindex="-1"><a class="header-anchor" href="#_1-hook-libart"><span>1.Hook_Libart</span></a></h2><p><code>libart.so</code>: 在 Android 5.0（Lollipop）及更高版本中，<code>libart.so</code> 是 Android 运行时（ART，Android Runtime）的核心组件，它取代了之前的 Dalvik 虚拟机。可以在 <code>libart.so</code> 里找到 JNI 相关的实现。</p><p>PS:在高于安卓10的系统里，so的路径是/apex/com.android.runtime/lib64/libart.so，低于10的则在system/lib64/libart.so</p><table><thead><tr><th>函数名称</th><th>参数</th><th>描述</th><th>返回值</th></tr></thead><tbody><tr><td><code>RegisterNatives</code></td><td><code>JNIEnv *env, jclass clazz, const JNINativeMethod *methods, jint nMethods</code></td><td>反注册类的本地方法。类将返回到链接或注册了本地方法函数前的状态。该函数不应在本地代码中使用。相反，它可以为某些程序提供一种重新加载和重新链接本地库的途径。</td><td>成功时返回0；失败时返回负数</td></tr><tr><td><code>GetStringUTFChars</code></td><td><code>JNIEnv*env, jstring string, jboolean *isCopy</code></td><td>通过JNIEnv接口指针调用，它将一个代表着Java虚拟机中的字符串jstring引用，转换成为一个UTF-8形式的C字符串</td><td>-</td></tr><tr><td><code>NewStringUTF</code></td><td><code>JNIEnv *env, const char *bytes</code></td><td>以字节为单位返回字符串的 UTF-8 长度</td><td>返回字符串的长度</td></tr><tr><td><code>FindClass</code></td><td><code>JNIEnv *env, const char *name</code></td><td>通过对象获取这个类。该函数比较简单，唯一注意的是对象不能为NULL，否则获取的class肯定返回也为NULL。</td><td>-</td></tr><tr><td><code>GetMethodID</code></td><td><code>JNIEnv *env, jclass clazz, const char *name, const char *sig</code></td><td>返回类或接口实例（非静态）方法的方法 ID。方法可在某个 clazz 的超类中定义，也可从 clazz 继承。GetMethodID() 可使未初始化的类初始化。</td><td>方法ID，如果找不到指定的方法，则为NULL</td></tr><tr><td><code>GetStaticMethodID</code></td><td><code>JNIEnv *env, jclass clazz, const char *name, const char *sig</code></td><td>获取类对象的静态方法ID</td><td>属性ID对象。如果操作失败，则返回NULL</td></tr><tr><td><code>GetFieldID</code></td><td><code>JNIEnv *env, jclass clazz, const char *name, const char *sig</code></td><td>回Java类（非静态）域的属性ID。该域由其名称及签名指定。访问器函数的GettypeField 及 SettypeField系列使用域 ID 检索对象域。GetFieldID() 不能用于获取数组的长度域。应使用GetArrayLength()。</td><td>-</td></tr><tr><td><code>GetStaticFieldID</code></td><td><code>JNIEnv *env,jclass clazz, const char *name, const char *sig</code></td><td>获取类的静态域ID方法</td><td>-</td></tr><tr><td><code>Call&lt;type&gt;Method</code>, <code>Call&lt;type&gt;MethodA</code>, <code>Call&lt;type&gt;MethodV</code></td><td><code>JNIEnv *env, jobject obj, jmethodID methodID, .../jvalue *args/va_list args</code></td><td>这三个操作的方法用于从本地方法调用Java 实例方法。它们的差别仅在于向其所调用的方法传递参数时所用的机制。</td><td>NativeType，具体的返回值取决于调用的类型</td></tr><tr><td></td><td></td><td></td><td></td></tr></tbody></table><p><img src="'+k+'" alt="图片"></p><p><a href="https://github.com/lasting-yang/frida_hook_libart" target="_blank" rel="noopener noreferrer">frida_hook_libart</a></p><p>yang神的hook三件套</p><p>简单介绍:</p><p>hook_art.js：hook art中的jni函数并且有打印参数和返回值，使用之前记得先加上过滤的so名称，另外高版本的系统也需要在脚本68行的过滤修改成<code>_ZN3art3JNI</code>(最好是加载libart.so查看一下)，这个脚本包含了hook_RegisterNatives.js的内容(但不太稳定，做个了解即可)</p><p>hook_RegisterNatives.js：hook打印动态注册的函数<br><img src="data:image/webp;base64,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" alt="图片"><br> hook_artmethod.js：打印所有java函数的调用<br><img src="'+l+'" alt="图片"></p><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>frida -U -f com.zj.wuaipojie -l hook_RegisterNatives.js --no-pause</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><code>Hook_RegisterNatives</code></p><div class="language-js line-numbers-mode" data-ext="js" data-title="js"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> find_RegisterNatives</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">params</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 在 libart.so 库中枚举所有符号（函数、变量等）</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> symbols</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Module</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">enumerateSymbolsSync</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">libart.so</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  </span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> addrRegisterNatives</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> null</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // 用于存储 RegisterNatives 方法的地址</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 遍历所有符号来查找 RegisterNatives 方法</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    for</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &lt;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> symbols</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">length</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">        let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> symbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> symbols</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">];</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // 当前遍历到的符号</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 检查符号名称是否符合 RegisterNatives 方法的特征</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">symbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">indexOf</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">art</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &gt;=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &amp;&amp;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> //RegisterNatives 是 ART（Android Runtime）环境的一部分</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">                symbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">indexOf</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">JNI</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &gt;=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &amp;&amp;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  //RegisterNatives 是 JNI（Java Native Interface）的一部分</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">                symbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">indexOf</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">RegisterNatives</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &gt;=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &amp;&amp;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> //检查符号名称中是否包含 &quot;RegisterNatives&quot; 字样。</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">\t\tsymbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">indexOf</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">CheckJNI</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &lt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> //CheckJNI 是用于调试和验证 JNI 调用的工具，如果不过滤，会有两个RegisterNatives，而带有CheckJNI的系统一般是关闭的，所有要过滤掉</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            addrRegisterNatives</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> symbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">address</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // 保存方法地址</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">RegisterNatives is at </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> symbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">address</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> symbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // 输出地址和名称</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">            hook_RegisterNatives</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">addrRegisterNatives</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // 调用hook函数</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        }</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> hook_RegisterNatives</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">addrRegisterNatives</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 确保提供的地址不为空</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">addrRegisterNatives</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> !=</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> null</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 使用 Frida 的 Interceptor hook指定地址的函数</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        Interceptor</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">attach</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">addrRegisterNatives</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">            // 当函数被调用时执行的代码</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">            onEnter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">args</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                // 打印调用方法的数量</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">                console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">[RegisterNatives] method_count:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> args</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]);</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                // 获取 Java 类并打印类名</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">                let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> java_class</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> args</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">];</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">                let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> class_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Java</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">vm</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">tryGetEnv</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">().</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">getClassName</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">java_class</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                </span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">                let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> methods_ptr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> ptr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">args</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]);</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // 获取方法数组的指针</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">                let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> method_count</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> parseInt</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">args</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]);</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // 获取方法数量</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                // 遍历所有方法</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">\t\t\t\t//jni方法里包含三个部分：方法名指针、方法签名指针和方法函数指针。每个指针在内存中占用 Process.pointerSize 的空间（这是因为在 32 位系统中指针大小是 4 字节，在 64 位系统中是 8 字节）。为了提高兼容性，统一用Process.pointerSize，系统会自动根据架构来适配</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">                for</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &lt;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> method_count</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                    // 读取方法的名称、签名和函数指针</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">                    let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> name_ptr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Memory</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">readPointer</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">methods_ptr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">add</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Process</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">pointerSize</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">));</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">//读取方法名的指针。这是每个方法结构体的第一部分，所以直接从起始地址读取。</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">                    let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> sig_ptr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Memory</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">readPointer</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">methods_ptr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">add</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Process</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">pointerSize</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Process</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">pointerSize</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">));</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">//读取方法签名的指针。这是结构体的第二部分，所以在起始地址的基础上增加了一个指针的大小</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">                    let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> fnPtr_ptr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Memory</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">readPointer</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">methods_ptr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">add</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Process</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">pointerSize</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Process</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">pointerSize</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">));</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">//读取方法函数的指针。这是结构体的第三部分，所以在起始地址的基础上增加了两个指针的大小（Process.pointerSize * 2）。</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                    // 将指针内容转换为字符串</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">                    let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Memory</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">readCString</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">name_ptr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">                    let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> sig</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Memory</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">readCString</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">sig_ptr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                    // 获取方法的调试符号</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">                    let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> symbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> DebugSymbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">fromAddress</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">fnPtr_ptr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                    // 打印每个注册的方法的相关信息</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">                    console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">[RegisterNatives] java_class:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> class_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">name:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">sig:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> sig</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">fnPtr:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> fnPtr_ptr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">  &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> fnOffset:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> symbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> callee:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> DebugSymbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">fromAddress</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">this</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">returnAddress</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">));</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">                }</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">            }</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        });</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">setImmediate</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">find_RegisterNatives</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // 立即执行 find_RegisterNatives 函数</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>hook_GetStringUTFChars</code><br><img src="data:image/webp;base64,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" alt="图片"></p><div class="language-js line-numbers-mode" data-ext="js" data-title="js"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> hook_GetStringUTFChars</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> GetStringUTFChars_addr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> null</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // jni 系统函数都在 libart.so 中</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> module_libart</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Process</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">findModuleByName</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">libart.so</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> symbols</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> module_libart</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">enumerateSymbols</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    for</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &lt;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> symbols</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">length</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">        var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> symbols</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">].</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> ((</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">indexOf</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">JNI</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &gt;=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">            &amp;&amp;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">indexOf</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">CheckJNI</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> ==</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> -</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">            &amp;&amp;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">indexOf</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">art</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &gt;=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">            if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">indexOf</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">GetStringUTFChars</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &gt;=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                // 获取到指定 jni 方法地址</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">                GetStringUTFChars_addr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> symbols</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">].</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">address</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">            }</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        }</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    Java</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">perform</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(){</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        Interceptor</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">attach</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">GetStringUTFChars_addr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">            onEnter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">args</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">){</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">            },</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> onLeave</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">retval</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">){</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                // retval const char*</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">\t\t\t\tconsole</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">GetStringUTFChars onLeave : </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> ptr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">retval</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">readCString</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">());</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">\t\t\t\tif</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ptr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">retval</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">readCString</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">().</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">indexOf</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">普通</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &gt;=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">){</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">\t\t\t\t\tconsole</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">GetStringUTFChars onLeave : </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> ptr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">retval</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">readCString</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">());</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">\t\t\t\t\tconsole</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Thread</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">backtrace</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">this</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">context</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Backtracer</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">ACCURATE</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">map</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">DebugSymbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">fromAddress</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">join</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\n</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\n</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">\t\t\t\t}</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">            }</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        })</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    })</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> main</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(){</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    Java</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">perform</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(){</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        hook_GetStringUTFChars</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    });</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">setImmediate</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">main</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-hook-libc" tabindex="-1"><a class="header-anchor" href="#_2-hook-libc"><span>2.Hook_Libc</span></a></h2><p><code>libc.so</code>: 这是一个标准的 C 语言库，用于提供基本的系统调用和功能，如文件操作、字符串处理、内存分配等。在Android系统中，<code>libc</code> 是最基础的库之一。</p><table><thead><tr><th>类别</th><th>函数名称</th><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>字符串类操作</td><td>strcpy</td><td><code>char *dest, const char *src</code></td><td>将字符串 src 复制到 dest</td></tr><tr><td></td><td>strcat</td><td><code>char *dest, const char *src</code></td><td>将字符串 src 连接到 dest 的末尾</td></tr><tr><td></td><td>strlen</td><td><code>const char *str</code></td><td>返回 str 的长度</td></tr><tr><td></td><td>strcmp</td><td><code>const char *str1, const char *str2</code></td><td>比较两个字符串</td></tr><tr><td>文件类操作</td><td>fopen</td><td><code>const char *filename, const char *mode</code></td><td>打开文件</td></tr><tr><td></td><td>fread</td><td><code>void *ptr, size_t size, size_t count, FILE *stream</code></td><td>从文件读取数据</td></tr><tr><td></td><td>fwrite</td><td><code>const void *ptr, size_t size, size_t count, FILE *stream</code></td><td>写入数据到文件</td></tr><tr><td></td><td>fclose</td><td><code>FILE *stream</code></td><td>关闭文件</td></tr><tr><td>网络IO类操作</td><td>socket</td><td><code>int domain, int type, int protocol</code></td><td>创建网络套接字</td></tr><tr><td></td><td>connect</td><td><code>int sockfd, const struct sockaddr *addr, socklen_t addrlen</code></td><td>连接套接字</td></tr><tr><td></td><td>recv</td><td><code>int sockfd, void *buf, size_t len, int flags</code></td><td>从套接字接收数据</td></tr><tr><td></td><td>send</td><td><code>int sockfd, const void *buf, size_t len, int flags</code></td><td>通过套接字发送数据</td></tr><tr><td>线程类操作</td><td>pthread_create</td><td><code>pthread_t *thread, const pthread_attr_t *attr, void *(*start_routine)(void *), void *arg</code></td><td>创建线程</td></tr><tr><td>进程控制操作</td><td>kill</td><td><code>pid_t pid, int sig</code></td><td>向指定进程发送信号</td></tr><tr><td>系统属性查询操作</td><td><code>__system_property_get</code></td><td><code>const char *name, char *value</code></td><td>从Android系统属性服务中读取指定属性的值</td></tr><tr><td></td><td>uname</td><td><code>struct utsname *buf</code></td><td>获取当前系统的名称、版本和其他相关信息</td></tr><tr><td></td><td>sysconf</td><td><code>int name</code></td><td>获取运行时系统的配置信息，如CPU数量、页大小</td></tr></tbody></table><p><code>hook_kill</code></p><p><img src="data:image/webp;base64,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" alt="图片"></p><div class="language-js line-numbers-mode" data-ext="js" data-title="js"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> replaceKILL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 查找libc.so库中kill函数的地址</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> kill_addr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Module</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">findExportByName</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">libc.so</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">kill</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 使用Interceptor.replace来替换kill函数</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    Interceptor</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">replace</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">kill_addr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> new</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> NativeCallback</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">arg0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> arg1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 当kill函数被调用时，打印第一个参数（通常是进程ID）</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">arg0=&gt; </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> arg0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 打印第二个参数（通常是发送的信号）</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">arg1=&gt; </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> arg1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 打印调用kill函数的堆栈跟踪信息</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">libc.so!kill called from:</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\n</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> +</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            Thread</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">backtrace</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">this</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">context</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Backtracer</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">ACCURATE</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">            .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">map</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">DebugSymbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">fromAddress</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">join</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\n</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\n</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    },</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">int</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">int</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">int</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]))</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>hook_pthread_create</code>6</p><div class="language-js line-numbers-mode" data-ext="js" data-title="js"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> hook_pthread_create</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(){</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    //hook反调试</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> pthread_create_addr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Module</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">findExportByName</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">libc.so</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">pthread_create</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">pthread_create_addr: </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> pthread_create_addr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    Interceptor</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">attach</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">pthread_create_addr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,{</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        onEnter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">args</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">){</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">args</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">],</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> args</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">],</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> args</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">],</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> args</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">4</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]);</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        },</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">onLeave</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">retval</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">){</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">retval is =&gt;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">retval</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        }</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    })</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>hook_str_cmp</code><br><img src="data:image/webp;base64,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" alt="图片"></p><div class="language-js line-numbers-mode" data-ext="js" data-title="js"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> hook_strcmp</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> pt_strcmp</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Module</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">findExportByName</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">libc.so</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">strcmp</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    Interceptor</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">attach</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">pt_strcmp</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        onEnter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">args</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">            var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> str1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> args</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">].</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">readCString</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">            var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> str2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> args</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">].</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">readCString</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">            if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">str2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">indexOf</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">hh</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> !==</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> -</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">                console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">strcmp--&gt;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> str1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> str2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">                this</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">printStack</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">            }</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        },</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> onLeave</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">retval</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">            if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">this</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">printStack</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">                var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> stack</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Thread</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">backtrace</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">this</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">context</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Backtracer</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">ACCURATE</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">                    .</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">map</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">DebugSymbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">fromAddress</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">join</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\n</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">                console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Stack trace:</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\n</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> stack</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">            }</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        }</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    })</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-hook-libdl" tabindex="-1"><a class="header-anchor" href="#_3-hook-libdl"><span>3.Hook_Libdl</span></a></h2><p><code>libdl.so</code>是一个处理动态链接和加载的标准库，它提供了<code>dlopen</code>、<code>dlclose</code>、<code>dlsym</code>等函数，用于在运行时动态地加载和使用共享库</p><table><thead><tr><th>类别</th><th>函数名称</th><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>动态链接库操作</td><td>dlopen</td><td><code>const char *filename, int flag</code></td><td>打开动态链接库文件</td></tr><tr><td></td><td>dlsym</td><td><code>void *handle, const char *symbol</code></td><td>从动态链接库中获取符号地址</td></tr></tbody></table><p><code>Hook_dlsym</code>获取jni静态注册方法地址<br><img src="data:image/webp;base64,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" alt="图片"></p><div class="language-js line-numbers-mode" data-ext="js" data-title="js"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> hook_dlsym</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> dlsymAddr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Module</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">findExportByName</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">libdl.so</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">dlsym</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    Interceptor</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">attach</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">dlsymAddr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        onEnter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">args</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">            this</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">args1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> args</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">];</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        },</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        onLeave</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">retval</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">            var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> module</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Process</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">findModuleByAddress</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">retval</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">            if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">module</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> ===</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> null</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> return</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">this</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">args1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">readCString</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(),</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> module</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> retval</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> retval</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sub</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">module</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">base</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">));</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        }</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    });</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-hook-linker" tabindex="-1"><a class="header-anchor" href="#_4-hook-linker"><span>4.Hook_Linker</span></a></h2><p>Linker是Android系统动态库so的加载器/链接器，通过android源码分析 init 和 init_array 是在 callConstructor 中被调用的<br><img src="data:image/webp;base64,UklGRuIOAABXRUJQVlA4TNYOAAAvqgI0AD/BNrJtJaeA7xYRupVA/y1ATuRaDKNIsp20gE8OJ87UN/EVIwMTaMhRAJvItp2sgE8ODpIJOoyhDROvoqLPAuY//vebjwMSRLDAjAVmEEarWoUEkUzPStIAflSJAD34/SAggASHH7iswOn6QVjW2XSBgF1dMVybVDFPEwbktpEkSZT/ZldW9TXY/UbEBFDJ5a7LeSvdaM6N2Ze1LVqasj2qKWmoIU1pbwg6XVptTL3RUgrKjb3bQIY5a980lG53+Ko999A6oVJ5T7li+a6DO/nOVZeefYyDH6vk9xz7Vevvkf7WfovdyjfsK9Ns+o0c/Fu9xI/6u9pXcOJH9nXUtW0PGinQrlKiGxR2h9SajUqU8z9Eyfu+X0pnym5/RfRfFmPbcdscF0Sz37fwcQmJGP6kYNtu2Dba/7ZniIcPECQhnFMnImRBkly3zSqhn3TtLWALBLG+gz9b8ejG1D7Bh7+d2h/3x8uWEEJOY2geHy1hV8vSDRL9M/54hby7n7Il43r+UKu4kO7DFyTG33KTRt/72qWfimog8LEIqUc6SFevcm/Jaan7nPZQSHMaqe0SYO0fQjem97AvJIftnx7dmB4E/EwI81LFDrFxW+1wYpnfjaD/aT0ehggRDaRHuJ533c85B/00LzsAKl6GeXkAm/LIJmwq+ilucublmWJF7vDghFhvJ8iT58FluH3eldLZU1FbyrHYFc39l7/HefFb38fJoMlm3ElFAoNzGSJ1GdF3RDGJquIri4wJX9FkCGQj6uSnzUXkr35CFwmHrLefN5OSGlSUfiuaFbY2l0KsA0WzwUYgKWw5RPq1SHGb66HCsj9ZttIG/IGkfdYMwTYH8FOxGtBenpd9IwXNASThyTumOehpYyQ9qU/6Tc3uZCjOILefIAk3vv4zfI3oXV9BmX8pOMJoBRitBPjieJexJ65BWmT27CQ9lWz2IVnQ/XcSI4dHQihmKdOEfuAGwlYlF06iakDRINgANIXbdXO9CGvRThG5klCl0DBCttAG/Imk5R8+eORtgnDUsGukmLKNGtiGNAdY8VFP7Jx7041YU6AcF/cgU7wM1/NmWh2/CMNKn0Lfrtdf58VshN+p1pc4K4sIMShKcP9TBPdfFq56wlpNBruEaacKQNia5OIVjIkzAoNgA9AUPq2UGEI/I6E3Nqq0efyBpNUhCyGTbPoIibqed45UTNiQ5gArvgH0yXwU50XhCX8rgohcvFtLCCJTQTaIjLpqGPWY8wtlGBYZPlZQvl/pwm42AAFGMEGDMO1sgsKebNiOeakd7Rw2AnSFrfQvo3E2YSEqla5nhcffklz4hyE0B5pzGcQgGx8RKS9qYhvSnPUkYLfccSi+E7+2r6C+0ZGal376a9NbBWkm/6NLbEQVsKHv7f78bXHS5TTZqiST121AWI0X8kFXtEHBbbACYgqLbi2WIDEUKxQe/7WNaKSfCCt5eY71iEg5UaMgIc1LouwaqAzdjRNYJqSWbo61r7Jh6huUXE1as09rzUBWy921qW3veuOu5v9gUw/ZrGhiPyj9kFXjzSvlQYrpxkhbvQ+JlBc1sQ1pXhLLVQo50grjw/1cBh3Q+77MBWv2FDX9pILjwFK6DN+2/98+xxZwIZWpWQ2gBEJrTVC61E9xRLud7kVTuGWEQ8ErBqAnMFm4OfyJkhU0EWozU8V5z0jpCoJRA9sEzV1QLEzx3VuwvOinKNelbzs0sAgkp8CIkHA25p5GkzNak2YwS4Ir4LpFA1Dyoay3KYNcGfo9DH3mG2A1hFaDFTb3C6FobGwEmsIKlygbYPtCA3oCbYfbwhZIAv880EfQ75zqe0eKcwCjBrYhzY2eklXPvaetzHkbdxk5xm6UmHm4ZIQC3Q2SaJCEta1yoLloBL+AtqrGhqYapFQ6H3Wn66chwURt26lMSu2KczllGoMRWWEtpEbwqaBoVca6zaEpLLNjJYegBbJ2g56WNnED/kAS+CtQBIFcwBkxe9zztDe3pSgHKGpiG9Ec9FSAntQn1/pjzW6vuM8D352/ZOR63ke/88Zz3Bl1WqpPRhkxFO1Arf7eQG3xRuHy7wnWHztQq783EFv8Yp6uO31aCPExtele/dI62cd43uq01M8OT9dzPEtg4BCY3Bh3m566wWm3Xl2fhG0TBQmnjQlywz4MwsJ7Xvm0criexR0qHhL5kAyTNE9XCnEABtWG9PoB3GsVQnE9vlO/Ys/wK366vIQkwV4lIG2s1h34v/t7lhQHFzAhs5DD0osIQrOUbB/0PJmhiCT1wIYEa9fKGXBYCW49RrmVsLf7KVmXl4jCqip8Jm3y7N+B8w7PEniEDDXthy/ISBFBaJaSXU8YjSXksiRJUm9dhETf69ezLOsL/UUnA+gznOwCihVMdKyQoaJy5DzCs4Srq1W4MkJEQAAorVTtNRm8IalnDuBew17qQha5XgR7HFMcfkQcY7qdFMSAOoO/nQxwiChXrw+dN3iW1kDCoPCc5agupX5KYJvhWLQF1XNmBNi9hsc02QzoVjS3VQdHPczOAoMvyaoIkxMTtujQualnaSscGT34Cvsy0cntzqB7DU61G3PdaEUnQa6Hb/INh4ALZGFFU4a1eTny5q6epZ1wZPTgK+zmcq1xb9C9dhn++J3NxhmUgMQILxOWj9yMrgLvIB37m5f1LCXDuUwHGQm6wpcheaUXI1LUU06jUUhkv5ZkSd66oYJdKZse1ukDgwbil74a1/UsZaNig9XKKB1AYdrDMIFdM0m99bR1PGHdUEWA+N4oSfeAqOwULCT5P8XvTb3BOzTH/eGneJbsSMZR5jJoF4GMHjxKkKbWzIpuOinv+Qdyr4lpQ0nwIk5dbJN3qFZwtL68tJLU16v4Ep3U5iHgL4a/7NJPlvfXJzPW//jjf0sMKGgs4mMU82V5d29dtg3Ajy5Plzj4e/VeUTgF1vF9qc5p/l2yPXMadeY9fBLkQPopHsO+kD8QTFd+GHYGu1Z9RlGbFlASTFnwu1d2Q5nGc4Jd38Om0MYGIlcTJUXz/qC67pW0aSElxZQF+anCmlVxWAqsPQ3EUiMlRXMBTfB0KRAHFaxEpF4Nm5YDw4SXdln+Nlh55BhruEAKLGGhnNhAFa6OaA7ohqfLUaeJAmBL4RewablQTFkACtY8ErJ1HZwCKwC9gVYrdhHNLZrg6YodFImq2LSIkmjKWr9hhF+FkZCs4+QUWDq0BiKYUkRzi9d6unbACb+YTQsoKaYsJz+V0w0SsnWdnALLw50BYpiSqLmD13i6KsIJv5xNy3QxxZRlRxVKz0jI1nVyCix/8DYvOwSIKYmaO4fneLqqH6rZtCwlyZTF87DZbxyZAks83BkgriVISdXcQQM8XTG4oCho0zKURFMWJL9WnPgpJ6fA0iE1kL2CxUkJVXMHHfB0KaCoFRR+HZsWUFJMWSIPIdjEL3RwCqwAtAYyQEohzS2a4OlygVELIPxKNi1LSTBloXHLBJt56+HgFFgBiA0EUkPCtIjmFl+narYDeoU0DAdcoy+NB5ahxHyhVAqs+6Afnq4nOO7ekwLLLj77zZQv65PYvZKvbf27ZHuumutcWfskbJpI+Sh2r9vjrDk/WIF/hN2LbJACHmj3Cmn+XNTyLB1h98JyusECXmj30jVHNChflrS0a+mGxe1efLaUBbzQ7hXQnNCffFmSuWttntp2L8ynDSHghXYvWXNEf/JlSeauVenadi/xbCNZwCFe91I1Z7QpX5Z+RoUH2L04WkkIOMTrXqrmjEbly1LPqPAEu1cRDLCAQ7zuJWruoD35sjTP0gl2L8cxYgFHeN1L1dxBg/Jl6afVtnv5QA8hIB3fda+Y5gYtypflQIB8RoVLD6lt99L5js0BXveKaW7QnnxZirnLNn1tu1cFh3rdK4Lm5Mv6Gnav5uTLer3d6xMBxiKfw+7VDk8XX7R8D7vXrxhPl+xispTeNMD6eFWz+Qp4Qu2AS/7pQITI8YA1+ZMJxe7VS7zA0xV1MTGuKRMPcpbdoxSu2WspXraPKYID6acETzsp5FAK6Qkrcax/jLSSDGAtxbv2McW11RGEzokV3KOUZABrJV7g6QqtDIXnY7WCA/GA+3b2gtX0zNtND21tq6t41j6mGA4E3/iPd+E9Sq1b22orXraPqRVOIHhYpuAepTQDWCtxZ09XHtixugYCRvu4QylBTxcIwLS7p73A0xV2MRkmGMj/lOMOpZCe5CuJ0UoxgHXz5Qs8XTkuJhsITAtX3aOUYAAbnKrZeGxwyj2suYH/i1RmE+7dgR3Ep6kWwUy1tvwY+JlZi+DwebqSUHQipRvTy4TcsOti/7+pNXrY/W9qlfw3Ufu8Kry0a6D2eUVMOujp6k++LEYGb0jqrTeJpcRQzTR3NSpf1qIMSGH1dLdTsj9VNncN1D6vLJOamKd9XtU2dw3UPq8qnzZP+7yqbO6aqH1e1TV3/Tjc59UP3H1epbRdOzxdXd/nVU7bfW3kB6L/nqx8m9aYQZvw2mDTUjX77qOb+7yKLdJag5ZDOtD6nfagZfu82mfTcnqFhjr0CS3b51WuTStwWYk6BPDxPV074ISfadOK1wdoQovi43q6KsIJP9OmFakPMBVf19NV/ZBp04q8kYp58HTF4IIi26YV+JQAXKhgIDxdCihqBYWfY9MKfCENJsbvIBq2z6scm5beYipsjFWx+8ZGmQ+/ouuf/b/9+o+bWgS//WkF7vB0Y3oP+x5y2P4D0Y3p9UKEyBlQkmJNJnKSYs1KLYL4x2Q/s/LAUalFkP+Y7IdWHjgmtQiaLyb7rSoP/LKerjyYQLx82cMPrTxwTGoRNF+h80MrD5yVWgTVS3R/aOWBs1KLoOLMygOHpRZB9WKyn1l54LDUIqiae1Ue+BPP01UAf/7XIvizrBbBpmnK+8e0FsFmUmsRbCa1FsFmUmsRbCa1FsFmUmsRbCa1FsGm/7UIDhTsLjGgoLFI09HCWgQbjSY+/unCl6lFsCeLD3tdi+Cf/7UIDlEtgn/+1yL4538tgv2UjYfqM59W4A5PN6b3sO8hh+3vpuR0RTemlwkRIodByY7VXrQ=" alt="图片"></p><p><code>hookInit和hookInitArray</code><br><a href="https://bbs.kanxue.com/thread-280135.htm" target="_blank" rel="noopener noreferrer">frida hook init_array自吐新解</a></p><p>经过安卓源码比对，从Android 8 ~ 14，结构体中<code>init_array</code>的位置都很稳定，提取部分头文件信息在CModule中定义一个soinfo结构体，接着定义一个接受一个<code>soinfo</code>指针参数和一个<code>callback</code>函数的函数，输出<code>init_array</code>信息</p><div class="language-js line-numbers-mode" data-ext="js" data-title="js"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> hook_call_constructors</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 初始化变量</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> get_soname</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> null</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> call_constructors_addr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> null</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> hook_call_constructors_addr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 根据进程的指针大小找到对应的linker模块</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> linker</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> null</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Process</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">pointerSize</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> ==</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 4</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        linker</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Process</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">findModuleByName</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">linker</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        linker</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Process</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">findModuleByName</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">linker64</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 枚举linker模块中的所有符号</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> symbols</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> linker</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">enumerateSymbols</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    for</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> index</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> index</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &lt;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> symbols</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">length</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> index</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">        let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> symbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> symbols</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">index</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">];</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 查找名为&quot;__dl__ZN6soinfo17call_constructorsEv&quot;的符号地址</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">symbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">name</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> ==</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">__dl__ZN6soinfo17call_constructorsEv</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            call_constructors_addr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> symbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">address</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 查找名为&quot;__dl__ZNK6soinfo10get_sonameEv&quot;的符号地址，获取soname</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        }</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">symbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">name</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> ==</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">__dl__ZNK6soinfo10get_sonameEv</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            get_soname</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> new</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> NativeFunction</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">symbol</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">address</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">pointer</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">pointer</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]);</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        }</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 如果找到了所有需要的地址和函数</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">hook_call_constructors_addr</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &amp;&amp;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> call_constructors_addr</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &amp;&amp;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> get_soname</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 挂钩call_constructors函数</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        Interceptor</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">attach</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">call_constructors_addr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,{</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">            onEnter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">args</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">){</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                // 从参数获取soinfo对象</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">                let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> soinfo</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> args</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">];</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                // 使用get_soname函数获取模块名称</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">                let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> soname</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> get_soname</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">soinfo</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">readCString</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                // 调用tell_init_info函数并传递一个回调，用于记录构造函数的调用信息</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">                tell_init_info</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">soinfo</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> new</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> NativeCallback</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">((</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">count</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> init_array_ptr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> init_func</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =&gt;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">                    console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">`</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">[call_constructors] </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">soname</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> count:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">count</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">`</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">                    console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">`</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">[call_constructors] init_array_ptr:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">init_array_ptr</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">`</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">                    console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">`</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">[call_constructors] init_func:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">init_func</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> -&gt; </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">${</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">get_addr_info</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">init_func</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">`</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                    // 遍历所有初始化函数，并打印它们的信息</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">                    for</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> index</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> index</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &lt;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> count</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> index</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">                        let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> init_array_func</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> init_array_ptr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">add</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Process</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">pointerSize</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> index</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">readPointer</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">                        let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> func_info</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> get_addr_info</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">init_array_func</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">                        console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">`</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">[call_constructors] init_array:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">index</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">init_array_func</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> -&gt; </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">func_info</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">`</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">                    }</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">                },</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">void</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">int</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">pointer</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">pointer</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]));</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">            }</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        });</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-frida-rpc" tabindex="-1"><a class="header-anchor" href="#_5-frida-rpc"><span>5.frida_rpc</span></a></h2><p>frida 提供了一种跨平台的 rpc(就是Remote Procedure Call 远程过程调用) 机制，通过 frida rpc 可以在主机和目标设备之间进行通信，并在目标设备上执行代码，简单理解就是可以不需要分析某些复杂加密，通过传入参数获取返回值，进而来实现python或易语言来调用的一系列操作，多用于爬虫。</p><p><code>包名附加进程</code></p><div class="language-python line-numbers-mode" data-ext="python" data-title="python"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> frida</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> sys</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">jsCode </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ...... </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;&quot;&quot;</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">script</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">exports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">rpcfunc</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">process </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> frida</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">get_usb_device</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">().</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">attach</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">包名</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 获取USB设备并附加到应用</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">script </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> process</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">create_script</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">jsCode</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 创建并加载脚本</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">script</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">load</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 执行脚本</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">sys</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">stdin</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">read</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 保持脚本运行状态，防止它执行完毕后立即退出</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>spawn方式启动</code></p><div class="language-python line-numbers-mode" data-ext="python" data-title="python"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> frida</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> sys</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">jsCode </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ...... </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;&quot;&quot;</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">script</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">exports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">rpcfunc</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">device </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> frida</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">get_usb_device</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">pid </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> device</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">spawn</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">([</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">包名</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">])</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    #以挂起方式创建进程</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">process </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> device</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">attach</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">pid</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">script </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> process</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">create_script</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">jsCode</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">script</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">load</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">device</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">resume</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">pid</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  #加载完脚本, 恢复进程运行</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">sys</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">stdin</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">read</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>连接非标准端口</code></p><div class="language-python line-numbers-mode" data-ext="python" data-title="python"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> frida</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> sys</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">jsCode </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ...... </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;&quot;&quot;</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">script</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">exports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">rpcfunc</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">process </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> frida</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">get_device_manager</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">().</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">add_remote_device</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">192.168.1.22:6666</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">attach</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">包名</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">script </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> process</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">create_script</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">jsCode</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">script</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">load</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">sys</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">stdin</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">read</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-js line-numbers-mode" data-ext="js" data-title="js"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> get_url</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> ChallengeNinth</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Java</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">use</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">com.zj.wuaipojie.ui.ChallengeNinth</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    ChallengeNinth</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">updateUI</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">].</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">implementation</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">list</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">        let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> ret</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> this</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">updateUI</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">list</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 获取List的大小</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">        var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> size</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> list</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">size</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 遍历并打印List中的每个ImageEntity对象</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        for</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &lt;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> size</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">            var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> imageEntity</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Java</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">cast</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">list</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">get</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">),</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Java</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">use</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">com.zj.wuaipojie.entity.ImageEntity</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">));</span></span>\n<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">imageEntity</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">value</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> imageEntity</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">cover</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">value</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        }</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> ret</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    };</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>需要提前pip安装好的几个库</p><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>frida-tools==9.2.4，uvicorn，fastapi，requests</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="python" data-title="python"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 导入需要的库</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">from</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> fastapi </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> FastAPI</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">from</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> fastapi</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">responses </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> JSONResponse</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> frida</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> sys</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> uvicorn</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 创建FastAPI应用实例</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">app </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> FastAPI</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 定义一个GET请求的路由&#39;/download-images/&#39;</span></span>\n<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">@</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">app</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">get</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/download-images/</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">def</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> download_images</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">():</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # 定义处理frida消息的回调函数</span></span>\n<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    def</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> on_message</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">message</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> data</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">):</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        message_type </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> message</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">type</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        if</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> message_type </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">==</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">send</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>\n<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">            print</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">[* message]</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> message</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">payload</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">])</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        elif</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> message_type </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">==</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">error</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">            stack </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> message</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">stack</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>\n<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">            print</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">[* error]</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> stack</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        else</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>\n<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">            print</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">message</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # Frida脚本代码，用于在目标应用内部执行</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    jsCode </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;&quot;</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    function getinfo(){</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        var result = [];</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        Java.perform(function(){</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">            Java.choose(&quot;com.zj.wuaipojie.ui.ChallengeNinth&quot;,{</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">                onMatch:function(instance){</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">                    instance.setupScrollListener(); // 调用目标方法</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">                },</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">                onComplete:function()</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">{}</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">            });</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">            </span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">            Java.choose(&quot;com.zj.wuaipojie.entity.ImageEntity&quot;,{</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">                onMatch:function(instance){</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">                    var name = instance.getName();</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">                    var cover = instance.getCover();</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">                    result.push(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">{name</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">:</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> name, cover: cover}</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">); // 收集数据</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">                },</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">                onComplete:function()</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">{}</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">            });</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        });</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        return result; // 返回收集的结果</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    }</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    rpc.exports = {</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        getinfo: getinfo // 导出函数供外部调用</span></span>\n<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    };</span></span>\n<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">    &quot;&quot;&quot;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # 使用frida连接到设备并附加到指定进程</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    process </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> frida</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">get_usb_device</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">().</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">attach</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">com.zj.wuaipojie</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # 创建并加载Frida脚本</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    script </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> process</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">create_script</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">jsCode</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    script</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">on</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">message</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> on_message</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 设置消息处理回调</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    script</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">load</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 加载脚本</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    getcovers </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> script</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">exports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">getinfo</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 调用脚本中的函数获取信息</span></span>\n<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    print</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">getcovers</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # 返回获取的信息作为JSON响应</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> JSONResponse</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">content</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">getcovers</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 主入口，运行FastAPI应用</span></span>\n<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">if</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> __name__</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> ==</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">__main__</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>\n<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    uvicorn</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">app</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> host</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">127.0.0.1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> port</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">8000</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 使用uvicorn作为ASGI服务器启动应用</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>写一段python的requests代码，访问http://127.0.0.1:8000/download-images/端口，会获得如下的json数据，按照名字把图片爬取到同目录的pic文件夹里，并写好注释</span></span>\n<span class="line"><span>[{</span></span>\n<span class="line"><span>&quot;name&quot;: &quot;霸王别姬&quot;,</span></span>\n<span class="line"><span>&quot;cover&quot;: &quot;https://p0.meituan.net/movie/ce4da3e03e655b5b88ed31b5cd7896cf62472.jpg@464w_644h_1e_1c&quot;</span></span>\n<span class="line"><span>},{</span></span>\n<span class="line"><span>&quot;name&quot;: &quot;这个杀手不太冷&quot;,</span></span>\n<span class="line"><span>&quot;cover&quot;: &quot;https://p1.meituan.net/movie/6bea9af4524dfbd0b668eaa7e187c3df767253.jpg@464w_644h_1e_1c&quot;</span></span>\n<span class="line"><span>},{</span></span>\n<span class="line"><span>&quot;name&quot;: &quot;肖申克的救赎&quot;,</span></span>\n<span class="line"><span>&quot;cover&quot;: &quot;https://p0.meituan.net/movie/283292171619cdfd5b240c8fd093f1eb255670.jpg@464w_644h_1e_1c&quot;</span></span>\n<span class="line"><span>}]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="五、答疑" tabindex="-1"><a class="header-anchor" href="#五、答疑"><span>五、答疑</span></a></h1><p>待更新</p><h1 id="六、视频及课件地址" tabindex="-1"><a class="header-anchor" href="#六、视频及课件地址"><span>六、视频及课件地址</span></a></h1><p><a href="https://pan.baidu.com/s/1cFWTLn14jeWfpXxlx3syYw?pwd=nqu9" target="_blank" rel="noopener noreferrer">百度云</a></p><p><a href="https://www.aliyundrive.com/s/TJoKMK6du6x" target="_blank" rel="noopener noreferrer">阿里云</a></p><p><a href="https://www.bilibili.com/video/BV1wT411N7sV/?spm_id_from=333.788&amp;vd_source=6dde16dc6479f00694baaf73a2225452" target="_blank" rel="noopener noreferrer">哔哩哔哩</a></p><p>PS:解压密码都是52pj，阿里云由于不能分享压缩包，所以下载exe文件，双击自解压</p><h1 id="七、其他章节" tabindex="-1"><a class="header-anchor" href="#七、其他章节"><span>七、其他章节</span></a></h1><p><a href="https://www.52pojie.cn/thread-1695141-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》一、模拟器环境搭建</a><br><a href="https://www.52pojie.cn/thread-1695796-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》二、初识APK文件结构、双开、汉化、基础修改</a><br><a href="https://www.52pojie.cn/thread-1701353-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》三、初识smail，vip终结者</a><br><a href="https://www.52pojie.cn/thread-1706691-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》四、恭喜你获得广告&amp;弹窗静默卡</a><br><a href="https://www.52pojie.cn/thread-1714727-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》五、1000-7=？&amp;动态调试&amp;Log插桩</a><br><a href="https://www.52pojie.cn/thread-1731181-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》六、校验的N次方-签名校验对抗、PM代{过}{滤}理、IO重定向</a><br><a href="https://www.52pojie.cn/thread-1740944-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》七、Sorry，会Hook真的可以为所欲为-Xposed快速上手(上)模块编写,常用Api</a><br><a href="https://www.52pojie.cn/thread-1748081-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》八、Sorry，会Hook真的可以为所欲为-xposed快速上手(下)快速hook</a><br><a href="https://www.52pojie.cn/thread-1762225-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》九、密码学基础、算法自吐、非标准加密对抗</a><br><a href="https://www.52pojie.cn/thread-1787667-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》十、不是我说，有了IDA还要什么女朋友？</a><br><a href="https://www.52pojie.cn/thread-1809646-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》十二、大佬帮我分析一下</a><br><a href="https://www.52pojie.cn/thread-1814917-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》番外实战篇1-某电影视全家桶</a><br><a href="https://www.52pojie.cn/thread-1823118-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》十三、是时候学习一下Frida一把梭了(上)</a><br><a href="https://www.52pojie.cn/thread-1838539-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》十四、是时候学习一下Frida一把梭了(中)</a><br><a href="https://www.52pojie.cn/thread-1840174-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》十五、是时候学习一下Frida一把梭了(下)</a><br><a href="https://www.52pojie.cn/thread-1859820-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》十六、是时候学习一下Frida一把梭了(终)</a><br><a href="https://www.52pojie.cn/thread-1892127-1-1.html#/" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》十七、你的RPCvs佬的RPC</a><br><a href="https://www.52pojie.cn/thread-1893708-1-1.html#/" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》番外实战篇2-【2024春节】解题领红包活动，启动!</a><br><a href="https://www.52pojie.cn/thread-1921073-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》十八、表哥，你也不想你的Frida被检测吧!(上)</a><br><a href="https://www.52pojie.cn/thread-1938862-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》十九、表哥，你也不想你的Frida被检测吧!(下)</a><br><a href="https://www.52pojie.cn/thread-1945285-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》二十、抓包学得好，牢饭吃得饱(上)</a><br><a href="https://www.52pojie.cn/thread-1951619-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》番外实战篇3-拨云见日之浅谈Flutter逆向</a><br><a href="https://www.52pojie.cn/thread-1967845-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》第二十一课、抓包学得好，牢饭吃得饱(中)</a><br><a href="https://www.52pojie.cn/thread-1982444-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》第二十二课、抓包学得好，牢饭吃得饱(下)</a><br><a href="https://www.52pojie.cn/thread-1995107-1-1.html" target="_blank" rel="noopener noreferrer">《安卓逆向这档事》第二十三课、黑盒魔法之Unidbg </a></p><h1 id="八、参考文档" tabindex="-1"><a class="header-anchor" href="#八、参考文档"><span>八、参考文档</span></a></h1><p><a href="http://luori366.github.io/JNI_doc/jni_function_mannual.html" target="_blank" rel="noopener noreferrer">JNI_doc</a></p><p><a href="https://www.cnblogs.com/qixingchao/p/11911787.html" target="_blank" rel="noopener noreferrer">安卓JNI精细化讲解，让你彻底了解JNI（二）：用法解析</a></p><p><a href="https://www.cnblogs.com/theseventhson/p/16110951.html" target="_blank" rel="noopener noreferrer">android逆向奇技淫巧二十六：基础库的hook&amp;x音检测frida方式之一（十一）</a></p><p><a href="https://www.jianshu.com/p/59d1d3054abe" target="_blank" rel="noopener noreferrer">so逆向筑基-hook init init_array 和JNI_OnLoad</a></p><p><a href="https://kevinspider.github.io/frida/frida-hook-so/" target="_blank" rel="noopener noreferrer">frida hook so</a></p><p><a href="https://wooyun.js.org/drops/Android%20Linker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html" target="_blank" rel="noopener noreferrer">Android&amp;Linker学习笔记</a></p>',75)]))}]]),e=JSON.parse('{"path":"/article/6eifv374/","title":"【Android逆向-正己】第十七课：你的RPCvs佬的RPC","lang":"zh-CN","frontmatter":{"title":"【Android逆向-正己】第十七课：你的RPCvs佬的RPC","createTime":"2025/01/03 01:03:13","permalink":"/article/6eifv374/","tags":["Android","逆向","Android逆向"],"description":"一、课程目标 1.了解常见系统库的hook 2.了解frida_rpc 二、工具 1.教程Demo(更新) 2.jadx-gui 3.VS Code 4.jeb 5.IDLE 三、课程内容 1.Hook_Libart libart.so: 在 Android 5.0（Lollipop）及更高版本中，libart.so 是 Android 运行时（ART...","head":[["meta",{"property":"og:url","content":"https://blog.529464.xyz/article/6eifv374/"}],["meta",{"property":"og:site_name","content":"only9464"}],["meta",{"property":"og:title","content":"【Android逆向-正己】第十七课：你的RPCvs佬的RPC"}],["meta",{"property":"og:description","content":"一、课程目标 1.了解常见系统库的hook 2.了解frida_rpc 二、工具 1.教程Demo(更新) 2.jadx-gui 3.VS Code 4.jeb 5.IDLE 三、课程内容 1.Hook_Libart libart.so: 在 Android 5.0（Lollipop）及更高版本中，libart.so 是 Android 运行时（ART..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-01-03T08:30:10.000Z"}],["meta",{"property":"article:tag","content":"Android"}],["meta",{"property":"article:tag","content":"逆向"}],["meta",{"property":"article:tag","content":"Android逆向"}],["meta",{"property":"article:modified_time","content":"2025-01-03T08:30:10.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"【Android逆向-正己】第十七课：你的RPCvs佬的RPC\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-01-03T08:30:10.000Z\\",\\"author\\":[]}"]]},"headers":[],"readingTime":{"minutes":14.08,"words":4225},"git":{"updatedTime":1735893010000,"contributors":[{"name":"only9464","email":"sky9464@qq.com","commits":1,"avatar":"https://avatars.githubusercontent.com/only9464?v=4","url":"https://github.com/only9464"}],"changelog":[{"hash":"c2297fcee496a29a39e5cd2db503b35d907c4f8e","date":1735893010000,"email":"sky9464@qq.com","author":"only9464","message":"Add Android逆向-正己 系列教程","commitUrl":"https://github.com/for9464/for9464.github.io/commit/c2297fcee496a29a39e5cd2db503b35d907c4f8e"}]},"autoDesc":true,"filePathRelative":"AndroidReserve/17第十七课、你的RPCvs佬的RPC.md","categoryList":[{"id":"d98243","sort":10002,"name":"AndroidReserve"}],"bulletin":false}')}}]);